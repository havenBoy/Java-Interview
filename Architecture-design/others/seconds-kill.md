### 秒杀系统设计

- 秒杀系统的难点

  - 瞬时的高并发

    会有很多的用户去抢一个东西，如果没有经过熔断或者限流，系统会立即崩掉，就像是遭受了DOS攻击；

  - 超卖问题

    高并发情况下需要保证商品卖完就不能再销售，所以在高并发情况下临界点的控制；

  - 性能问题

    在高并发的情形下，让用户有一个良好的用户体验，保证系统的性能问题；

- 设计的原则

  ​        秒杀系统的高并发请求，请求中的读操作是大于写操作的，那么大量的请求需要拦截在数据库的上游，写操作才能去触及数据库，这样就可以减少数据库的压力，避免读写锁的问题；

- 具体的步骤：

  - 前端
    - 秒杀活动的页面尽量设置为一些静态的页面，避免动态元素的加载，减轻前端的压力
    - 禁止用户重复的提交，可以使用js控制按钮在几秒中之内之内点击一次；
    - 把秒杀的静态页面提前刷新到CDN节点上，这样也可以缓解压力；
  - 后端
    - 请求到达后端后，做一个请求的队列，对于读操作的请求，直接去访问缓存
    - 对于写操作，可以设置一个写操作的队列，依次释放固定数目的写请求到数据库；
    - 超卖的问题，通过在数据库进行设置乐观锁实现，增加一个版本号；

  ​