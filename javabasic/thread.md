### 线程？ 进程？

- 进程

  资源分配的基本单位；

  PCB(Process Control Block) ,进程控制块，用来描述进程的基本信息以及运行状态，

- 线程

  独立调度的基本单位；

  一个进程中可以包含许多个线程，共享进程的资源；不同的应用可以理解为进程，一个应用中不同的功能可以理解为线程；

- **区别**

  - 拥有资源

    进程是资源分配的基本单位，线程本身不拥有资源，但是可以共享隶属进程内的资源；

  - 调度

    线程是独立调度的基本单位，处于同一进程中的线程切换不会引起进程的切换，处于不同进程的不同线程切换时会引起进程的切换

  - 系统开销

    进程的创建和销毁比线程的创建与销毁要大的多

  - 通信

    线程之间可以通过一个进程读写相互通信，进程通信借助（IPC）；

- **进程状态及其装换**

  ![图片](https://github.com/havenBoy/havenboy-java-Interview/blob/master/image/4.jpg)

  一般来说，进程的状态就3种，运行，阻塞，就绪，五态模型中加了新建状态和终止状态

  - 运行：进程占用CPU资源执行中；

  - 就绪：调用了start()方法后，随时可能被CPU调度执行；

  - 阻塞  : 进程在等待某一个资源或者事件而暂停运行；

    **转换**

    - 就绪 - 运行 ： 处于就绪态的进行被调度后，进入运行态；
    - 运行 - 阻塞 ： 由于进行需要请求资源啊或者等待事件的触发，是一种典型的由用户态装换为内核态；
    - 阻塞 - 就绪 ： 等待的资源或者事件触发时，完成阻塞到就绪的切换；
    - 运行 - 就绪 ： 处于运行态的进程在时间片使用完之后，由运行态变换为就绪态；

- 线程通信

  - 使用全局变量，声明时是volatile；
  - 在windows设计中，每一个线程都有自己的消息队列，所以消息队列可以实现线程之间的通信；
  - Event对象有2个状态，有无信号，线程可以监视有信号状态的事件，以便对事件的处理；

- 线程间的同步方式

  - 临界区

    在进入代码段的线程在leave之前，可以重复进入代码，此线程拥有了线程的所有权；在离开代码段之后，会释放对于此代码段的所有权；

  - 互斥量

    互斥量是内核对象，与临界区很相似；

  - 信号量

    可以运行多个线程在同一时间访问同一个资源，典型的PV操作；

  - 事件

    事件也是内核对象，可以解决线程之间的同步问题，也可以解决线程之间的互斥问题；

- 进程通信（IPC）

  - 管道（pipe）：

    是一种半双工的通信方式，数据只能单向流动，而且只能在父子进程中使用，还有一种是有名管道，也是一种半双工的通信，允许无血缘关系进程直接的通信；

  - 信号量：

    是一个计数器，用于进程之间的同步，控制多个进程对共享资源的访问；

  - 信号：比较复杂的通信方式，用于通知接收进程某个事件已经发生；

  - 消息队列：是一个保存在内核中消息的列表，用户进程可以添加消息，也可以从中读取消息；

  - 共享内存：映射一段能被其他进程所访问的内存，是为了解决其他进程通信方式效率低下而设计，通常与信号量配合使用，来实现进程之间的同步与通信；

  - 套接字（socket）：可以用于不同机器之间进程通信；